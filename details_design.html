
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Documentation for the PESTO toolbox" name="description"/>
<meta content="Airbus Defence and Space - Processing Factory Team" name="author"/>
<link href="https://airbusdefenceandspace.github.io/pesto/details_design.html" rel="canonical"/>
<link href="details_conventions.html" rel="prev"/>
<link href="details_cookbook.html" rel="next"/>
<link href="assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.11" name="generator"/>
<title>Design - PESTO : ProcESsing facTOry</title>
<link href="assets/stylesheets/main.4af4bdda.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#design-presentation">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="PESTO : ProcESsing facTOry" class="md-header__button md-logo" data-md-component="logo" href="index.html" title="PESTO : ProcESsing facTOry">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            PESTO : ProcESsing facTOry
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Design
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/AirbusDefenceAndSpace/pesto" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    AirbusDefenceAndSpace/pesto
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="PESTO : ProcESsing facTOry" class="md-nav__button md-logo" data-md-component="logo" href="index.html" title="PESTO : ProcESsing facTOry">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    PESTO : ProcESsing facTOry
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/AirbusDefenceAndSpace/pesto" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    AirbusDefenceAndSpace/pesto
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="get_started.html">
<span class="md-ellipsis">
    Get started
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Package an Algorithm
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Package an Algorithm
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="package_pesto_project.html">
<span class="md-ellipsis">
    Create a PESTO project
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="package_configuration.html">
<span class="md-ellipsis">
    Project configuration
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="package_docker_image.html">
<span class="md-ellipsis">
    Build the Docker image
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="package_test.html">
<span class="md-ellipsis">
    Test the Docker image
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Run the Algorithm
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Run the Algorithm
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="deploy_run_docker_image.html">
<span class="md-ellipsis">
    Run the packaged algorithm
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="deploy_web_service.html">
<span class="md-ellipsis">
    Web-service
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    PESTO commands
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            PESTO commands
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_init.html">
<span class="md-ellipsis">
    init
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_schemagen.html">
<span class="md-ellipsis">
    schemagen
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_build.html">
<span class="md-ellipsis">
    build
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_test.html">
<span class="md-ellipsis">
    test
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_run.html">
<span class="md-ellipsis">
    run
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="pesto_list.html">
<span class="md-ellipsis">
    list
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Tutorial
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="tutorial_pytorch.html">
<span class="md-ellipsis">
    Deploying a pytorch model
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    PESTO in details
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            PESTO in details
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="details_conventions.html">
<span class="md-ellipsis">
    Conventions
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Design
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="details_design.html">
<span class="md-ellipsis">
    Design
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#need-identification">
<span class="md-ellipsis">
      Need identification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#base-architecture-definition">
<span class="md-ellipsis">
      Base architecture definition
    </span>
</a>
<nav aria-label="Base architecture definition" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-runtime">
<span class="md-ellipsis">
      PESTO runtime
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-packaging-manager">
<span class="md-ellipsis">
      PESTO packaging manager
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-testing-framework">
<span class="md-ellipsis">
      PESTO testing framework
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-details">
<span class="md-ellipsis">
      Implementation details
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#processing-api-management">
<span class="md-ellipsis">
      Processing API management
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performances">
<span class="md-ellipsis">
      Performances
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="details_cookbook.html">
<span class="md-ellipsis">
    Cookbook
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="details_troubleshooting.html">
<span class="md-ellipsis">
    Troubleshooting
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#need-identification">
<span class="md-ellipsis">
      Need identification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#base-architecture-definition">
<span class="md-ellipsis">
      Base architecture definition
    </span>
</a>
<nav aria-label="Base architecture definition" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-runtime">
<span class="md-ellipsis">
      PESTO runtime
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-packaging-manager">
<span class="md-ellipsis">
      PESTO packaging manager
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pesto-testing-framework">
<span class="md-ellipsis">
      PESTO testing framework
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-details">
<span class="md-ellipsis">
      Implementation details
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#processing-api-management">
<span class="md-ellipsis">
      Processing API management
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performances">
<span class="md-ellipsis">
      Performances
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="design-presentation">Design presentation</h1>
<h2 id="introduction">Introduction</h2>
<p>PESTO stands for <strong>ProcESsing facTOry</strong> and was initially designed to answer the need for fast and efficient integration of image processing algorithms using deep learning (DL) in our ground segment products.</p>
<p>Next sections are organized as follows: </p>
<ul>
<li><a href="#need-identification">Need identification</a>: this section presents the expectations, what we would like to do.</li>
<li><a href="#base-architecture-definition">Base architecture identification</a>: this section details the architecture of Pesto. It describes how we answer to our objectives.</li>
<li><a href="#implementation-details">Implementation details</a>: this section details some technologies used by pesto</li>
<li><a href="#processing-api-management">Processing API management</a>: this section provides guidelines on how to design a processing API for PESTO.</li>
<li><a href="#performances">Performances</a>: this section tells how PESTO should perform, how we demonstrated it was scalable.</li>
</ul>
<h2 id="need-identification">Need identification</h2>
<p>The road from the design and development of a DL algorithm by data scientists to their integration in the image chain and finally the ground segment can be fastidious due to all the teams and all the required skills involved along the integration chain. Moreover, a DL solution, like cloud detection for instance, will usually be included in different products of our offer (like PNEO, DIGINEO or OneAtlas) having their own integration technologies, constraints and specificities. In addition, DL algorithms are frequently updated, either when the training dataset or the model is modified.
Therefore, we can’t afford to have an integration effort too long and complex, for each algorithm in each of our product.  </p>
<p>It is then clear that standardizing key APIs, defining a common process and sharing common tools could greatly facilitate the delivery of DL algorithms and by extension of data processing algorithms, either delivered by our providers or designed by ourselves.</p>
<p>From these remarks and an analysis of what should be PESTO, a base architecture is proposed in the next section.</p>
<h2 id="base-architecture-definition">Base architecture definition</h2>
<p>Let’s take the widespread use case of cloud detection on satellite imagery in order to introduce the main integration steps and possibilities. 
A classical workflow applied when images are received can be represented as follows:</p>
<p><img alt="image" src="img/CloudDetectionProcess.png"/></p>
<p><em><a name="fig-ipcloud">Figure: Illustration of a cloud detection pipeline</a></em></p>
<p>As we see, the cloud detection algorithm is integrated in a global image processing chain that will trigger many instances of it. Indeed, large scene images has to be split in smaller images that are compatible with the algorithm (RAM or GPU memory limit), and the processing needs to be distributed to provide high processing throughput and low latency. PESTO should then facilitate the integration of processing algorithms in various distributed processing frameworks used in our products. </p>
<p>In the current illustration, the algorithm processes images as they are received, but it might also be on user request for on-demand processing or based on an event triggered by a monitoring function in other scenario. PESTO should then facilitate the reuse of processing algorithms by various orchestrators used in our products.</p>
<p>The described pipeline does not detail the type and format of the data that is exchanged in between tasks. For image tiles, it could be a binary buffer containing the image itself or an URL pointing to a file to be fetched. Moreover, the information could be provided by different technologies (HTTP/REST, Apache KAFKA bus, SOAP,...). It will depend on the solution selected at the system level. But in any manner, the processing algorithm will need the image data. PESTO should then facilitate the definition of algorithms API and encourage the definition and use of common data types.</p>
<p>And as it was mentioned several times, the processing algorithm needs to be deployed in many places. Therefore, PESTO should allow implementing the strategy <em>develop and validate once, deploy everywhere</em>.</p>
<p>The base architecture of PESTO is then derived from these needs. PESTO is composed of a runtime proper to each processing function, a packaging manager to create PESTO runtimes tuned for each processing function and a testing framework.</p>
<h3 id="pesto-runtime">PESTO runtime</h3>
<p>The runtime is a webserver which conforms to an OpenAPI specification. The OpenAPI Specification (OAS) defines a standard, language-agnostic interface to RESTful APIs which allows both humans and computers to discover and understand the capabilities of the service without access to source code, documentation, or through network traffic inspection. When properly defined, a consumer can understand and interact with the remote service with a minimal amount of implementation logic, see <a href="https://swagger.io/specification/">SWAGGER</a>.</p>
<p>The architecture of the runtime is represented as follows:</p>
<p><img alt="image" src="img/PestoArchi.png"/></p>
<p><em><a name="fig-pestocloud">Figure: Architecture of a PESTO runtime for cloud detection</a></em></p>
<p>PESTO web server offers three web services that are :</p>
<ul>
<li><strong>/api/v1/health</strong>: provides information on the availability of the service</li>
<li><strong>/api/v1/describe</strong>: provides information on the processing service that is deployed. Information on inputs, outputs, deployment requirements and so on are given here. PESTO does not constrain the definition of input and output parameters to offer a versatile solution. In return, a standardization effort has to be conducted in parallel.</li>
<li><strong>/api/v1/process</strong>: call the processing function. Request parameters must respect the definition provided by <code>/api/v1/describe</code>.</li>
</ul>
<p>PESTO is also in charge to convert, when required, the data from the REST API to the processing API. For most of parameters, they won’t be any major conversion. In the current implementation, only the image type is converted such that the processing has access to the image data as a buffer. The philosophy is to remove any I/O operations from the algorithm implementation to limit the any adherence with the data source or destination.</p>
<p>The runtime is provided as a <strong>standalone docker image</strong> that can be deployed everywhere and how many times as necessary.</p>
<h3 id="pesto-packaging-manager">PESTO packaging manager</h3>
<p>The packaging manager is a set of tools and templates to help the data scientist to deliver its algorithm. 
Indeed, one goal of PESTO is really to ease the delivery of an algorithm designed by a data scientist.</p>
<p>The packaging workflow is described as follows:</p>
<p><img alt="image" src="img/PestoWorkflow.png"/></p>
<p><em><a name="fig-pestoworkflow">Figure: PESTO packaging workflow</a></em></p>
<h3 id="pesto-testing-framework">PESTO testing framework</h3>
<p>PESTO provides mechanisms to test the embedded processing function.
A set of input and expected output parameters are provided by the data scientist. 
Then, the <a href="pesto_test.html">test function</a> deploys the PESTO runtime and run tests.</p>
<h2 id="implementation-details">Implementation details</h2>
<p>PESTO is developed with Python3. Indeed, many Deep Leaning tools and frameworks are provided in this language. Moreover, Python can easily use native code if necessary.</p>
<p><a href="https://fastapi.tiangolo.com">FastAPI</a> is used to implement the webserver. It offers async operations which allow to write non-blocking code.</p>
<p>In order to make the link between requests on the web server and the processing implemented by the data scientist, a template to implement a python package and to provide a description of the API as well as build requirements is provided. </p>
<p>The python package is named <code>algorithm.process.Process</code>. The data scientist needs to fill the signature and the content of the process function and in particular include the call to the implementation of the processing function.</p>
<p>Then a set of configuration files have to be updated. A first set of configuration files (located in <code>pesto/api</code>) defines the API of the algorithm. Their content is described in the next section.</p>
<p>A second set of configuration files (located in <code>pesto/build</code>) defines how to build the runtime. 
We can define which root docker image to use, how to include DL models and parameters in the runtime, the name and version of the runtime... </p>
<p>One additional feature is the possibility to define several independent runtime profiles. For example, it is useful to define a runtime using only CPUs and a runtime using the GPU. </p>
<h2 id="processing-api-management">Processing API management</h2>
<p>The PESTO runtime is designed to be extremely versatile by letting a full freedom on the definition of interfaces. The solution can then address many, if not all, use cases, which makes it its strength. </p>
<p>PESTO does not guarantee the interoperability of processing functions which is also a key element in our ground segment solutions. Therefore, a complementary effort is conducted to standardize common data types in order to enforce interoperability.</p>
<p>PESTO recommended philosophy is then to capitalize JSON Schema defining data types as well as functions used to convert from the REST API type to the algorithm type (like it is done for images).</p>
<p>This effort has been conducted for Earth Observation data processing jointly with Airbus Defense and Space / Connected Intelligence teams. A common API, named geoprocessing-api, was then defined and can be found <a href="https://github.com/AirbusDefenceAndSpace/geoprocessing-api">here</a>.</p>
<p>We provide here some guidelines to define and manage JSON Schema used to define API.</p>
<ul>
<li>Define common data types and rely on existing ones as much as possible to ease interoperability,</li>
<li>Define data types that can be managed by higher level orchestrators: they need to known data types to provide the right information in the right format, possibly calling converters,</li>
<li>Define API that will allow to chain processing function.</li>
</ul>
<p>The definition of processing API should then be organized as depicted as follows:</p>
<p><img alt="image" src="img/geoapi.png"/></p>
<p><em><a name="fig-apimanagement">Figure: Processing API management</a></em></p>
<ul>
<li>
<p>MyDescribe.yml:</p>
<ul>
<li>
<p>Declares features of the process. It is used by orchestrators to select a service, deploy its docker image, feed it with the right data and exploit its result,</p>
</li>
<li>
<p>The Format is extremely open to support any type of micro-service, however it is already batch processing compliant.</p>
</li>
</ul>
</li>
<li>
<p>Default data types for GeoApplications:</p>
<ul>
<li>
<p><em>image.json</em>: Declares the format of an image and its attributes: compression type, spectral bands, sensor, ephemeris.</p>
</li>
<li>
<p><em>imageCapabilities</em>: Declares how to specify filters describing supported images.</p>
</li>
<li>
<p><em>inputCapabilities</em>: gather together all possible input capabilities of the project, somehow it references ImageCapabilities.json</p>
</li>
</ul>
</li>
</ul>
<h2 id="performances">Performances</h2>
<p>PESTO runtime is a wrapper around the algorithm to make it available as a web service. It transfers inputs and outputs from one side to the other. The intrinsic performances, i.e. performances related to the goal of the function like the detection rate for object detection, of the algorithm are not altered by PESTO. It can eventually add a little processing time or latency overhead, i.e. extrinsic performances. But PESTO should not affect them in a significative way as it simply passes REST API arguments to the algorithm. It should provide equivalent overhead on extrinsic performances as any web service implementation.</p>
<p>The memory overhead, that also characterizes the extrinsic performances, has not been evaluated yet. But in our use cases involving image processing, it should remain negligible.</p>
<div class="admonition example">
<p class="admonition-title">Example: GCP deployment</p>
<p>PESTO has been deployed at scale in Google Cloud Platform to process large satellite imagery. 
The architecture of the deployed system is represented as follows: </p>
<p><img alt="image" src="img/EoPaasArchitecture.png"/></p>
<p><em><a name="fig-pestoatscale">Figure: PESTO at scale for EO processing with GPU</a></em></p>
<p>PESTO runtimes are identified with the icon <img alt="logo" src="img/PestoArchiLogo.png"/>. </p>
<p>The platform was created with 3 GPU workers and 13 workers (with 8 CPU each) for PESTO runtimes.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example: Conductor deployment</p>
<ul>
<li>PESTO has also been deployed at larger scale with <a href="https://netflix.github.io/conductor/">Conductor</a> (Orchestrator from Netflix) to run a pipeline of two tasks provided as PESTO micro services:</li>
</ul>
<p><img alt="image" src="img/PestoWithConductor.png"/></p>
<p><em><a name="fig-pestowithconductor">Figure: PESTO at scale with Conductor</a></em></p>
<p>100 workers for PESTO were created.</p>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2023 Airbus Defence and Space
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="js/mermaid.min.js"></script>
</body>
</html>